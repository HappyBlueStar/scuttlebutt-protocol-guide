<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Dev Diary</title>
    <link rel="icon" href="img/favicon.png"/>
    <link rel="stylesheet" href="css/fonts.css"/>
    <link rel="stylesheet" href="css/guide.css"/>
    <link rel="stylesheet" href="css/diary.css"/>
</head>
<body>
    <header>
        <div class="title">
            <a href="index.html">
                <img src="img/logo.svg"/>
                <span>Scuttlebutt Protocol Guide</span>
            </a>
        </div>
        <nav>
            <a href="https://github.com/vtduncan/scuttlebutt-protocol-guide"><div>Repo</div></a>
            <a href="diary.html"><div>Dev Diary</div></a>
            <a href="mailto:scuttlebuttprotocolguide@vltf.org"><div>Feedback</div></a>
        </nav>
    </header>
    <main>
        <h1>Dev Diary</h1>
        <table class="calendar">
            <thead>
                <tr>
                    <th>Mon</th>
                    <th>Tue</th>
                    <th>Wed</th>
                    <th>Thu</th>
                    <th>Fri</th>
                    <th>Sat</th>
                    <th>Sun</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <time datetime="2017-12-11">11 <strong>Dec</strong> 2017</time>
                    </td>
                    <td>
                        <time datetime="2017-12-12">12</time>
                        <ul>
                            <li>Overhaul CSS</li>
                            <li>Split big ladder figure</li>
                            <li>Colorblind-friendly</li>
                        </ul>
                    </td>
                    <td>
                        <time datetime="2017-12-13">13</time>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2017-12-14">14</time>
                        <ul>
                            <li>Port handshake docs</li>
                            <li>Redraw handshake figures</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2017-12-15">15</time>
                        <ul>
                            <li>Simplify grid</li>
                            <li>Port code snippets</li>
                            <li>Box stream: read impls, start drawing</li>
                        </ul>
                    </td>
                    <td class="weekend">
                        <time datetime="2017-12-16">16</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2017-12-17">17</time>
                    </td>
                </tr>
                <tr>
                    <td class="workworkwork">
                        <time datetime="2017-12-18">18</time>
                        <ul>
                            <li>Draw box stream</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2017-12-19">19</time>
                        <ul>
                            <li>Explain box stream</li>
                            <li>Box stream test impl</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2017-12-20">20</time>
                        <ul>
                            <li>Fix handshake errors</li>
                            <li>Box stream psuedocode</li>
                        </ul>
                    </td>
                    <td class="afk">
                        <time datetime="2017-12-21">21</time>
                        <div class="afk"><span>AFK</span></div>
                    </td>
                    <td class="afk">
                        <time datetime="2017-12-22">22</time>
                        <div class="afk"><span>AFK</span></div>
                    </td>
                    <td class="weekend">
                        <time datetime="2017-12-23">23</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2017-12-24">24</time>
                    </td>
                </tr>
                <tr>
                    <td class="afk">
                        <time datetime="2017-12-25">25</time>
                        <div class="afk"><span>AFK</span></div>
                    </td>
                    <td class="afk">
                        <time datetime="2017-12-26">26</time>
                        <div class="afk"><span>AFK</span></div>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2017-12-27">27</time>
                        <ul>
                            <li>Read muxrpc and packet-stream</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2017-12-28">28</time>
                        <ul>
                            <li>Draw RPC figures</li>
                            <li>Table of contents</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2017-12-29">29</time>
                        <ul>
                            <li>Style RPC messages</li>
                            <li>Figure out createHistoryStream</li>
                            <li>Example RPC source</li>
                        </ul>
                    </td>
                    <td class="weekend">
                        <time datetime="2017-12-30">30</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2017-12-31">31</time>
                    </td>
                </tr>
                <tr>
                    <td class="afk">
                        <time datetime="2018-01-01">1 <strong>Jan</strong> 2018</time>
                        <div class="afk"><span>AFK</span></div>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-02">2</time>
                        <ul>
                            <li>Example RPC async</li>
                            <li>Document createHistoryStream options</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-03">3</time>
                        <ul>
                            <li>blobs.get</li>
                            <li>blobs.getSlice</li>
                            <li>blobs.has</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-04">4</time>
                        <ul>
                            <li>blobs.changes</li>
                            <li>blobs.createWants</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-05">5</time>
                        <ul>
                            <li>Restructure sections</li>
                        </ul>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-06">6</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-07">7</time>
                    </td>
                </tr>
                <tr>
                    <td class="workworkwork">
                        <time datetime="2018-01-08">8</time>
                        <ul>
                            <li>Sigchain drawing</li>
                            <li>Keys and identities</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-09">9</time>
                        <ul>
                            <li>Feed structure</li>
                            <li>Message format</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-10">10</time>
                        <ul>
                            <li>Move createHistoryStream</li>
                            <li>Blobs intro</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-11">11</time>
                        <ul>
                            <li>Blobs section</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-12">12</time>
                        <ul>
                            <li>Figure out invites</li>
                        </ul>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-13">13</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-14">14</time>
                    </td>
                </tr>
                <tr>
                    <td class="afk">
                        <time datetime="2018-01-15">15</time>
                        <div class="afk"><span>AFK</span></div>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-16">16</time>
                        <ul>
                            <li>Following</li>
                            <li>Pubs and invites</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-17">17</time>
                        <ul>
                            <li>Discovery</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-18">18</time>
                        <ul>
                            <li>Private messages</li>
                        </ul>
                    </td>
                    <td class="workworkwork">
                        <time datetime="2018-01-19">19</time>
                        <ul>
                            <li>Implementations table</li>
                        </ul>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-20">20</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-21">21</time>
                    </td>
                </tr>
                <tr>
                    <td class="workworkwork">
                        <time datetime="2018-01-22">22</time>
                        <div class="notice"><span>FINISH!</span></div>
                    </td>
                    <td>
                        <time datetime="2018-01-23">23</time>
                    </td>
                    <td>
                        <time datetime="2018-01-24">24</time>
                    </td>
                    <td>
                        <time datetime="2018-01-25">25</time>
                    </td>
                    <td>
                        <time datetime="2018-01-26">26</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-27">27</time>
                    </td>
                    <td class="weekend">
                        <time datetime="2018-01-28">28</time>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="key">
            <div><div class="workworkwork"></div> = time funded by grant</div>
        </div>

        <h2>Up next</h2>
        <ul>
            <li>Check that private messages explanation actually works when implemented.</li>
        </ul>

        <h2>To do at the end</h2>
        <ul>
            <li>Make usages of <em>hash</em> and <em>sha256</em> consistent. Specify which hmac is used.</li>
            <li>Make usages of <em>identity</em> and <em>public key</em> consistent.</li>
            <li>Example message contents.</li>
            <li>Annotated format boxes.</li>
            <li>Consistent indentation for code snippets.</li>
            <li>Regenerate all example messages so that signatures and IDs are valid.</li>
            <li>Check whether CSS fonts permeate into linked SVGs.</li>
            <li>Add SVG heights to img tags.</li>
            <li>Consider inlining SVGs to make text selectable.</li>
            <li>Move repo to somewhere official and make easy to find link from homepage.</li>
        </ul>

        <h2>Distant future</h2>
        <ul>
            <li>Link to implementations next to explanations.</li>
        </ul>

        <h2>Recent</h2>
        <h3>19 Jan</h3>
        <ul>
            <li>Make a table that links to implementations.</li>
        </ul>
        <h3>18 Jan</h3>
        <ul>
            <li>Write and draw figures for Private Messages section.</li>
        </ul>
        <h3>17 Jan</h3>
        <ul>
            <li>Figure out how UDP presence announcements work and write Discovery section.</li>
        </ul>
        <h3>16 Jan</h3>
        <ul>
            <li>Write section about following and visibility.</li>
            <li>Write pubs and invites section.</li>
        </ul>
        <h3>12 Jan</h3>
        <ul>
            <li>Figure out how invites and invite auth works.</li>
        </ul>
        <h3>11 Jan</h3>
        <ul>
            <li>Move blobs RPC docs into blobs section, tweak explanations about have and want.</li>
        </ul>
        <h3>10 Jan</h3>
        <ul>
            <li>Move <em>createHistoryStream</em> into feeds section.</li>
            <li>Start writing blobs section.</li>
        </ul>
        <h3>9 Jan</h3>
        <ul>
            <li>Add supporting text around feed structure drawing.</li>
            <li>Begin writing section on message format and how to calculate message IDs and signatures.</li>
        </ul>
        <h3>8 Jan</h3>
        <ul>
            <li>Draw a figure to show how signature chains link messages in a feed.</li>
            <li>Write the keys and identities section.</li>
        </ul>
        <h3>5 Jan</h3>
        <ul>
            <li>Overhaul the whole guide’s structure to allow keeping a cohesive narrative from start to end. Was unsatisfied with how it previously devolved into a list of RPC methods that needed a bunch of concepts introduced haphazardly.</li>
        </ul>
        <h3>4 Jan</h3>
        <ul>
            <li>Document RPC methods <em>blobs.changes</em> and <em>blobs.createWants</em>.</li>
        </ul>
        <h3>3 Jan</h3>
        <ul>
            <li>Document RPC methods <em>blobs.get</em>, <em>blobs.getSlice</em> and <em>blobs.has</em>.</li>
        </ul>
        <h3>2 Jan</h3>
        <ul>
            <li>Document <em>blobs.has</em> to show how RPC async messages work.</li>
            <li>Show examples of which options can be given to <em>createHistoryStream</em>.</li>
        </ul>
        <h3>29 Dec</h3>
        <ul>
            <li>Add styles for displaying RPC messages.</li>
            <li>Experiment with <em>createHistoryStream</em> to figure out what its arguments mean.</li>
            <li>Document an example RPC exchange showing how to call <em>createHistoryStream</em>.</li>
        </ul>
        <h3>28 Dec</h3>
        <ul>
            <li>Draw diagrams and write introduction for RPC protocol.</li>
            <li>Add styles for a table of contents.</li>
        </ul>
        <h3>27 Dec</h3>
        <ul>
            <li>Read source code for muxrpc and packet-stream.</li>
            <li>Test whether scuttlebot requires RPC messages to be aligned to box stream boundaries.</li>
        </ul>
        <h3>20 Dec</h3>
        <ul>
            <li>Tracked down and fixed errors in the handshake docs where scuttlebot works differently to what was described.</li>
            <li>Experimented with adding psuedocode to accompany the box stream figures, but decided against this because it wasn’t useful enough.</li>
        </ul>
        <h3>19 Dec</h3>
        <ul>
            <li>Wrote supporting text to go with box stream figures.</li>
            <li>Started making a test implementation of the handshake and box stream to check that it interoperates with a real scuttlebot.</li>
        </ul>
        <h3>18 Dec</h3>
        <ul>
            <li>Drew a better set of figures to explain box stream.</li>
        </ul>
        <h3>15 Dec</h3>
        <ul>
            <li>Simplified HTML structure so that the main grid no longer needs to be wrapped in centering divs.</li>
            <li>Add styling for code snippets and copy across handshake code from old docs.</li>
            <li>Learned how Box Stream works by reading implementations. Thank you, authors of the JavaScript, C, Go and Python implementations!</li>
            <li>Started drawing figures to explain Box Stream, but these will need more experimentation:</li>
        </ul>
        <img src="img/diary/box_stream_concepts.svg"/>
        <h3>14 Dec</h3>
        <ul>
            <li>Ported existing prose from the old handshake docs to the new layout. Now they make use of asides and inline key images.</li>
            <li>Remade handshake figures to be less visually noisy. Detached signatures from their message boxes to show that the message is not sent over the wire.</li>
        </ul>
        <h3>12 Dec</h3>
        <ul>
            <li>Yanked styles from <a href="https://distill.pub">Distill</a>. Make CSS layout handle wide figures and asides. Embed fonts, bigger paragraph text.</li>
            <li>Split up the big handshake ladder figure into an overview figure followed by explanations of each message. Too much stuff was crammed between each message in the old figure.</li>
            <li>Swapped out colors to avoid illegible combinations with black. Set up a deuter/prot/tritanopia-friendly color palette. Note to self: use fewer colors when remaking remaining figures. Explain what solids and outlines mean.</li>
        </ul>
    </main>

    <script>
        // Highlight today on the calendar (in my timezone)

        function tzDate(date, offsetHours) {
            let tzOffset = offsetHours * 3600 * 1000;
            let userOffset = (new Date()).getTimezoneOffset() * 60 * 1000;
            return new Date(date.getTime() + tzOffset + userOffset);
        }

        function zpad(num) {
            return ("00" + num).slice(-2);
        }

        function formatDate(date) {
            return date.getFullYear() + "-" + zpad(date.getMonth() + 1) + "-" + zpad(date.getDate());
        }

        let formattedDate = formatDate(tzDate(new Date(), 13));
        let el = document.querySelector("time[datetime='" + formattedDate + "']");
        if (el != null) {
            el.parentNode.classList.add("today");
        }
    </script>
</body>
</html>
